<div style="padding:1rem;"></div>

<div style="padding:1rem;display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:1rem;">
  <div *ngFor="let p of ps.photos; let i = index" style="border:1px solid #e5e7eb;border-radius:.8rem;overflow:hidden;background:white;">
    <img [src]="p.webviewPath" alt="" style="width:100%;aspect-ratio:1/1;object-fit:cover;cursor:pointer;" (click)="open(p)">
    <div style="padding:.6rem .8rem;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:.5rem;">
      <button (click)="like(p)" style="border:none;background:transparent;cursor:pointer;font-weight:600;display:flex;align-items:center;gap:.35rem;">
        <span [style.color]="p.liked ? '#ef4444' : '#374151'">‚ù§</span><span>{{ p.likes }}</span>
      </button>
      <small style="color:#6b7280">{{ when(p.createdAt) }}</small>
    </div>
    <div style="padding:0 .8rem .6rem .8rem; display:flex; justify-content:space-between; align-items:center; gap:.5rem;">
      <small style="color:#374151; font-weight:600;">{{ label(p) }}</small>
      <button *ngIf="p.latitude!=null && p.longitude!=null" (click)="goToMap(p)" style="font-size:.85rem;color:#2563eb;text-decoration:underline;background:transparent;border:none;cursor:pointer;">
        Voir sur la carte
      </button>
    </div>
    <button (click)="remove(i,p)" style="margin:.4rem .6rem .8rem auto;display:block;border:1px solid #e5e7eb;background:#f9fafb;border-radius:.5rem;padding:.3rem .6rem;cursor:pointer;">
      Supprimer
    </button>
  </div>
</div>

<div *ngIf="selected" (click)="close()" style="position:fixed;inset:0;background:rgba(0,0,0,.9);display:flex;align-items:center;justify-content:center;z-index:9999;">
  <img [src]="selected.webviewPath" alt="" style="max-width:96vw;max-height:90vh;object-fit:contain;border-radius:.75rem;box-shadow:0 10px 30px rgba(0,0,0,.5);">
  <button (click)="close()" style="position:absolute;top:16px;right:16px;background:#111827;color:#fff;border:none;border-radius:.75rem;padding:.5rem .8rem;cursor:pointer;">
    Fermer
  </button>
</div>

<button class="shutter-btn" (click)="take()">
  <span class="shutter-inner"></span>
</button>
